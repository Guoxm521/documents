<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>胡萝卜菜</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.ea438c07.css" as="style"><link rel="preload" href="/assets/js/app.bbc43154.js" as="script"><link rel="preload" href="/assets/js/2.9fe5dad5.js" as="script"><link rel="preload" href="/assets/js/29.8c08d254.js" as="script"><link rel="prefetch" href="/assets/js/10.0820a4e3.js"><link rel="prefetch" href="/assets/js/11.0b9f026d.js"><link rel="prefetch" href="/assets/js/12.f4e79c51.js"><link rel="prefetch" href="/assets/js/13.542c9627.js"><link rel="prefetch" href="/assets/js/14.a53c2e19.js"><link rel="prefetch" href="/assets/js/15.fa8feac6.js"><link rel="prefetch" href="/assets/js/16.d08caf4c.js"><link rel="prefetch" href="/assets/js/17.62c76c77.js"><link rel="prefetch" href="/assets/js/18.d3b32e78.js"><link rel="prefetch" href="/assets/js/19.69526bf5.js"><link rel="prefetch" href="/assets/js/20.5e55a82a.js"><link rel="prefetch" href="/assets/js/21.c2a4572c.js"><link rel="prefetch" href="/assets/js/22.5dfd5fb4.js"><link rel="prefetch" href="/assets/js/23.29ef0db4.js"><link rel="prefetch" href="/assets/js/24.d769d268.js"><link rel="prefetch" href="/assets/js/25.3ce1ff27.js"><link rel="prefetch" href="/assets/js/26.1bd4aec4.js"><link rel="prefetch" href="/assets/js/27.a12ffd25.js"><link rel="prefetch" href="/assets/js/28.de97d724.js"><link rel="prefetch" href="/assets/js/3.872bb4a3.js"><link rel="prefetch" href="/assets/js/30.de64ef10.js"><link rel="prefetch" href="/assets/js/31.9707c9e5.js"><link rel="prefetch" href="/assets/js/32.5ee24959.js"><link rel="prefetch" href="/assets/js/33.0aadd0ee.js"><link rel="prefetch" href="/assets/js/34.3b4e92af.js"><link rel="prefetch" href="/assets/js/35.8141258b.js"><link rel="prefetch" href="/assets/js/4.ff7c0758.js"><link rel="prefetch" href="/assets/js/5.4119f40d.js"><link rel="prefetch" href="/assets/js/6.83780561.js"><link rel="prefetch" href="/assets/js/7.d93d9b77.js"><link rel="prefetch" href="/assets/js/8.88d92839.js"><link rel="prefetch" href="/assets/js/9.cdb2092e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ea438c07.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="胡萝卜菜" class="logo"> <span class="site-name can-hide">胡萝卜菜</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页🎈
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端🐱‍👓" class="dropdown-title"><span class="title">前端🐱‍👓</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端🐱‍👓" class="mobile-dropdown-title"><span class="title">前端🐱‍👓</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/vue/" class="nav-link">
  vue笔记🤷‍♂️
</a></li><li class="dropdown-item"><!----> <a href="/前端/Javascript/" class="nav-link">
  JavaScript笔记🤦‍♀️
</a></li><li class="dropdown-item"><!----> <a href="/前端/Css/css常用命名.html" class="nav-link">
  Css😢
</a></li><li class="dropdown-item"><!----> <a href="/前端/小程序/云函数生成小程序链接.html" class="nav-link">
  小程序
</a></li></ul></div></div><div class="nav-item"><a href="/更多/Canvas.html" class="nav-link">
  更多🐱‍🏍
</a></div><div class="nav-item"><a href="/收藏/" class="nav-link">
  收藏❤
</a></div> <a href="https://github.com/Guoxm521/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页🎈
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端🐱‍👓" class="dropdown-title"><span class="title">前端🐱‍👓</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端🐱‍👓" class="mobile-dropdown-title"><span class="title">前端🐱‍👓</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/vue/" class="nav-link">
  vue笔记🤷‍♂️
</a></li><li class="dropdown-item"><!----> <a href="/前端/Javascript/" class="nav-link">
  JavaScript笔记🤦‍♀️
</a></li><li class="dropdown-item"><!----> <a href="/前端/Css/css常用命名.html" class="nav-link">
  Css😢
</a></li><li class="dropdown-item"><!----> <a href="/前端/小程序/云函数生成小程序链接.html" class="nav-link">
  小程序
</a></li></ul></div></div><div class="nav-item"><a href="/更多/Canvas.html" class="nav-link">
  更多🐱‍🏍
</a></div><div class="nav-item"><a href="/收藏/" class="nav-link">
  收藏❤
</a></div> <a href="https://github.com/Guoxm521/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/更多/Canvas.html" class="sidebar-link">Canvas</a></li><li><a href="/更多/杂七杂八.html" class="sidebar-link">杂七杂八</a></li><li><a href="/更多/Git操作.html" class="sidebar-link">Git操作</a></li><li><a href="/更多/发布npm包.html" class="sidebar-link">发布npm包</a></li><li><a href="/更多/docker学习.html" class="sidebar-link">docker学习</a></li><li><a href="/更多/MySQL.html" class="sidebar-link">MySQL</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="language-python extra-class"><pre class="language-python"><code>pip install webdriver<span class="token operator">-</span>helper


<span class="token keyword">import</span> time

<span class="token keyword">from</span> webdriver_helper <span class="token keyword">import</span> <span class="token operator">*</span>

driver <span class="token operator">=</span> get_webdriver<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;http://www.baidu.com&quot;</span><span class="token punctuation">)</span>

time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">11111</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> os
<span class="token keyword">import</span> time

<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>wait <span class="token keyword">import</span> WebDriverWait
<span class="token keyword">from</span> webdriver_helper <span class="token keyword">import</span> get_webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC

driver <span class="token operator">=</span> get_webdriver<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;https://admtest.wesais.cn/&quot;</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&quot;/html/body/div/div/form/div[2]/div/div/input&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&quot;/html/body/div/div/form/div[3]/div/div/input&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">&quot;arguments[0].click();&quot;</span><span class="token punctuation">,</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">&quot;#app &gt; div &gt; form &gt; button&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 错误提示  捕获  element message</span>
<span class="token comment"># DEMOI= WebDriverWait(driver,10).until(EC.visibility_of(driver.find_element(By.CSS_SELECTOR,&quot;.el-message--error&quot;)))</span>
<span class="token comment"># print('123',DEMOI)</span>



demo <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">&quot;.el-scrollbar a&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> item <span class="token keyword">in</span> demo<span class="token punctuation">:</span>
    driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">&quot;arguments[0].click();&quot;</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span>
    file_name <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y_%m_%d_%H_%M_%S'</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.png'</span>
    path <span class="token operator">=</span> <span class="token string">'E:/demo/images/'</span>
    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>path<span class="token punctuation">,</span> file_name<span class="token punctuation">)</span>
    driver<span class="token punctuation">.</span>get_screenshot_as_file<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    <span class="token comment"># href = item.get_attribute('href')</span>
    <span class="token comment"># driver.save_screenshot(href+'.png')</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;执行完毕&quot;</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2023/06/20 星期二  10:12:12</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.bbc43154.js" defer></script><script src="/assets/js/2.9fe5dad5.js" defer></script><script src="/assets/js/29.8c08d254.js" defer></script>
  </body>
</html>
