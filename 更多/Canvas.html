<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CanvasRenderingContext2D | 胡萝卜菜</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.c026dc41.css" as="style"><link rel="preload" href="/assets/js/app.301249b9.js" as="script"><link rel="preload" href="/assets/js/2.98a928dc.js" as="script"><link rel="preload" href="/assets/js/17.b6e2a80b.js" as="script"><link rel="prefetch" href="/assets/js/10.d143f98d.js"><link rel="prefetch" href="/assets/js/11.04e4d282.js"><link rel="prefetch" href="/assets/js/12.eaa32a3f.js"><link rel="prefetch" href="/assets/js/13.87094c39.js"><link rel="prefetch" href="/assets/js/14.8b1b723c.js"><link rel="prefetch" href="/assets/js/15.88c3947d.js"><link rel="prefetch" href="/assets/js/16.e633246c.js"><link rel="prefetch" href="/assets/js/18.f2eb6ab1.js"><link rel="prefetch" href="/assets/js/19.0c2f02d3.js"><link rel="prefetch" href="/assets/js/3.d513ac0e.js"><link rel="prefetch" href="/assets/js/4.e60618c7.js"><link rel="prefetch" href="/assets/js/5.ff62ab57.js"><link rel="prefetch" href="/assets/js/6.c67fe5c2.js"><link rel="prefetch" href="/assets/js/7.b35fa887.js"><link rel="prefetch" href="/assets/js/8.915fa3b1.js"><link rel="prefetch" href="/assets/js/9.7bfac69d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c026dc41.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="胡萝卜菜" class="logo"> <span class="site-name can-hide">胡萝卜菜</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/vue/" class="nav-link">
  vue笔记
</a></li><li class="dropdown-item"><!----> <a href="/前端/Javascript/" class="nav-link">
  JavaScript笔记
</a></li><li class="dropdown-item"><!----> <a href="/前端/Css/css常用命名.html" class="nav-link">
  Css
</a></li></ul></div></div><div class="nav-item"><a href="/更多/Canvas.html" class="nav-link">
  更多
</a></div><div class="nav-item"><a href="/收藏/" class="nav-link">
  收藏
</a></div> <a href="https://github.com/Guoxm521/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/vue/" class="nav-link">
  vue笔记
</a></li><li class="dropdown-item"><!----> <a href="/前端/Javascript/" class="nav-link">
  JavaScript笔记
</a></li><li class="dropdown-item"><!----> <a href="/前端/Css/css常用命名.html" class="nav-link">
  Css
</a></li></ul></div></div><div class="nav-item"><a href="/更多/Canvas.html" class="nav-link">
  更多
</a></div><div class="nav-item"><a href="/收藏/" class="nav-link">
  收藏
</a></div> <a href="https://github.com/Guoxm521/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/更多/Canvas.html" class="active sidebar-link">Canvas</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/更多/Canvas.html#canvasrenderingcontext2d" class="sidebar-link">CanvasRenderingContext2D</a></li><li class="sidebar-sub-header"><a href="/更多/Canvas.html#drawimage" class="sidebar-link">drawImage()</a></li><li class="sidebar-sub-header"><a href="/更多/Canvas.html#createimagedata" class="sidebar-link">createImageData</a></li><li class="sidebar-sub-header"><a href="/更多/Canvas.html#putimagedata" class="sidebar-link">putImageData</a></li><li class="sidebar-sub-header"><a href="/更多/Canvas.html#getimagedata" class="sidebar-link">getImageData</a></li><li class="sidebar-sub-header"><a href="/更多/Canvas.html#htmlcanvaselement-toblob" class="sidebar-link">HTMLCanvasElement.toBlob()</a></li><li class="sidebar-sub-header"><a href="/更多/Canvas.html#htmlcanvaselement-todataurl" class="sidebar-link">HTMLCanvasElement.toDataURL()</a></li><li class="sidebar-sub-header"><a href="/更多/Canvas.html#案例" class="sidebar-link">案例</a></li></ul></li><li><a href="/更多/杂七杂八.html" class="sidebar-link">杂七杂八</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="canvasrenderingcontext2d"><a href="#canvasrenderingcontext2d" class="header-anchor">#</a> CanvasRenderingContext2D</h2> <blockquote><p>CanvasRenderingContext2D顾名思义就是“Canvas 2D渲染上下文”，可以理解为下面代码中的context。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> context <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>context暴露了大量的API属性和方法，可以用来绘制文本，图形以及像素处理等，可以说是2D Canvas应用的核心所在。</p></blockquote> <h3 id="绘制矩形"><a href="#绘制矩形" class="header-anchor">#</a> 绘制矩形</h3> <p><code>CanvasRenderingContext2D.clearRect()</code>
清除指定矩形区域内部所有的像素信息为初始色（通常为透明）。
<code>CanvasRenderingContext2D.fillRect()</code>
矩形填充，可以填充颜色，渐变，图案等。
<code>CanvasRenderingContext2D.strokeRect()</code>
矩形描边。</p> <h3 id="绘制文本"><a href="#绘制文本" class="header-anchor">#</a> 绘制文本</h3> <p><code>CanvasRenderingContext2D.fillText()</code>
文字填充，可以填充纯色，渐变或者图案。
<code>CanvasRenderingContext2D.strokeText()</code>
文字描边。
<code>CanvasRenderingContext2D.measureText()</code>
文字测量。返回TextMetrics对象，该对象的width属性值就是字符占据的宽度。</p> <h3 id="线条样式"><a href="#线条样式" class="header-anchor">#</a> 线条样式</h3> <p><code>CanvasRenderingContext2D.lineWidth</code>
线条宽度，主使用场景是描边，默认宽度是1.0，支持小数。
<code>CanvasRenderingContext2D.lineCap</code>
线条端点的样式。支持如下属性值：<code>butt</code>（默认值，断头，无端帽），<code>round</code>（圆形端帽），<code>square</code>（方形端帽）。
<code>CanvasRenderingContext2D.lineJoin</code>
线条转角的样式。支持如下属性值：<code>miter</code>（默认值，尖角），<code>round</code>（圆角），<code>bevel</code>（平角）。
<code>CanvasRenderingContext2D.miterLimit</code>
尖角限制比率。线条的尖角如果没有限制，在线条粗角度小的情况下会很长很长，因此，需要一个限制比率。默认是10。
<code>CanvasRenderingContext2D.getLineDash()</code>
返回当前虚线数值。返回值是一个偶数个数的数组
<code>CanvasRenderingContext2D.setLineDash()</code>
设置线条为虚线。
<code>CanvasRenderingContext2D.lineDashOffset</code>
设置虚线的起始偏移。</p> <h3 id="文本样式"><a href="#文本样式" class="header-anchor">#</a> 文本样式</h3> <p><code>CanvasRenderingContext2D.font</code>
设置字体相关样式，包括字号，字体信息。默认值是<code>10px sans-serif</code>。
<code>CanvasRenderingContext2D.textAlign</code>
设置文本水平对齐方式。支持属性值有：start（默认值），end，left，right以及center。
<code>CanvasRenderingContext2D.textBaseline</code>
设置文本基线对齐方式。支持属性值有：top，hanging，middle，alphabetic（默认值），ideographic，bottom。
<code>CanvasRenderingContext2D.direction</code>
设置文本显示方向。支持属性值有：inherit（默认值），ltr和rtl。</p> <h3 id="填充和描边"><a href="#填充和描边" class="header-anchor">#</a> 填充和描边</h3> <p><code>CanvasRenderingContext2D.fillStyle</code>
填充样式。默认值是#000000纯黑色。
<code>CanvasRenderingContext2D.fill()</code>
填充。
<code>CanvasRenderingContext2D.strokeStyle</code>
描边样式。默认值是#000000纯黑色。
<code>CanvasRenderingContext2D.stroke()</code>
描边。</p> <h3 id="渐变相关"><a href="#渐变相关" class="header-anchor">#</a> 渐变相关</h3> <p>Canvas中与渐变相关的方法就是创建线性渐变和径向渐变这两个方法。</p> <p><code>CanvasRenderingContext2D.createLinearGradient()</code>
创建线性渐变。
<code>CanvasRenderingContext2D.createRadialGradient()</code>
创建径向渐变。</p> <h3 id="图案相关"><a href="#图案相关" class="header-anchor">#</a> 图案相关</h3> <p>Canvas中与图案相关的方法就是创建图案对象方法。</p> <p><code>CanvasRenderingContext2D.createPattern()</code>
创建图案。图案内容可以是图片，可以是<code>&lt;canvas&gt;</code>元素，也可以是渐变。此方法返回<code>CanvasPattern</code>对象。</p> <h3 id="阴影相关"><a href="#阴影相关" class="header-anchor">#</a> 阴影相关</h3> <p>Canvas中与阴影相关的属性就是下面这些。</p> <p><code>CanvasRenderingContext2D.shadowBlur</code>
阴影模糊大小。默认值是0。
<code>CanvasRenderingContext2D.shadowColor</code>
阴影颜色。默认值是全透明黑色。
<code>CanvasRenderingContext2D.shadowOffsetX</code>
阴影水平偏移大小。默认值是0。
<code>CanvasRenderingContext2D.shadowOffsetY</code>
阴影垂直偏移大小。默认值是0。</p> <h3 id="绘制路径"><a href="#绘制路径" class="header-anchor">#</a> 绘制路径</h3> <p>下面的方法可以用来处理路径对象。</p> <p><code>CanvasRenderingContext2D.beginPath()</code>
开始一个新路径。
<code>CanvasRenderingContext2D.closePath()</code>
闭合一个路径。
<code>CanvasRenderingContext2D.moveTo()</code>
路径绘制起始点。
<code>CanvasRenderingContext2D.lineTo()</code>
绘制直线到指定坐标点。
<code>CanvasRenderingContext2D.bezierCurveTo()</code>
绘制贝赛尔曲线到指定坐标点。
<code>CanvasRenderingContext2D.quadraticCurveTo()</code>
绘制二次贝赛尔曲线到指定坐标点。
<code>CanvasRenderingContext2D.arc()</code>
绘制圆弧（包括圆）。
<code>CanvasRenderingContext2D.arcTo()</code>
绘制圆弧，和之前的点以直线相连。
<code>CanvasRenderingContext2D.rect()</code>
绘制矩形路径。
<code>CanvasRenderingContext2D.ellipse()</code>
绘制椭圆路径。
<code>CanvasRenderingContext2D.clip()</code>
创建剪裁路径，之后绘制的路径只有在里面的才会显示。</p> <h3 id="位置检测"><a href="#位置检测" class="header-anchor">#</a> 位置检测</h3> <p><code>CanvasRenderingContext2D.isPointInPath()</code>
当前点是否在指定路径内。
<code>CanvasRenderingContext2D.isPointInStroke()</code>
当前点是否在指定路径描边上。</p> <h3 id="变换"><a href="#变换" class="header-anchor">#</a> 变换</h3> <p>旋转缩放等变换方法。</p> <p><code>CanvasRenderingContext2D.rotate()</code>
旋转。
<code>CanvasRenderingContext2D.scale()</code>
缩放。
<code>CanvasRenderingContext2D.translate()</code>
位移。
<code>CanvasRenderingContext2D.transform()</code>
当前矩阵变换基础上再次矩阵变换。
<code>CanvasRenderingContext2D.setTransform()</code>
直接重置为当前设置的矩阵变换。</p> <h3 id="透明度和层级"><a href="#透明度和层级" class="header-anchor">#</a> 透明度和层级</h3> <p>一个是控制全局透明度，另外一个可以改变层级关系，设置混合模式，以及实现遮罩效果等。</p> <p><code>CanvasRenderingContext2D.globalAlpha</code>
全局透明度。
<code>CanvasRenderingContext2D.globalCompositeOperation</code>
设置图形叠加时候的混合方式，可以用来改变绘制元素上下叠加关系，也就是层级。</p> <h3 id="图片与像素"><a href="#图片与像素" class="header-anchor">#</a> 图片与像素</h3> <p>绘制图片和图像像素信息处理方法。</p> <p><code>CanvasRenderingContext2D.drawImage()</code>
图片绘制在画布上。
<code>CanvasRenderingContext2D.createImageData()</code>
创建一个新的空白的ImageData对象。
<code>CanvasRenderingContext2D.getImageData()</code>
获取Canvas画布的设定区域的ImageData对象。
<code>CanvasRenderingContext2D.putImageData()</code>
给定的ImageData对象应用在Canvas画布上。</p> <h3 id="canvas状态"><a href="#canvas状态" class="header-anchor">#</a> Canvas状态</h3> <p>Canvas状态管理几个方法。</p> <p><code>CanvasRenderingContext2D.save()</code>
存储当前Canvas的状态。
<code>CanvasRenderingContext2D.restore()</code>
恢复Canvas到前一次存储的状态。
<code>CanvasRenderingContext2D.canvas</code>
反向识别当前上下文源自哪个HTMLCanvasElement。</p> <h3 id="其他方法"><a href="#其他方法" class="header-anchor">#</a> 其他方法</h3> <p>其他一些不常用的API方法。</p> <p><code>CanvasRenderingContext2D.drawFocusIfNeeded()</code>
如果给定元素被聚焦，则该方法在当前路径周围绘制焦点环。
<code>CanvasRenderingContext2D.scrollPathIntoView()</code>
将当前路径或给定路径滚动到视图中。</p> <hr> <h2 id="drawimage"><a href="#drawimage" class="header-anchor">#</a> drawImage()</h2> <blockquote><p>canvas与web结合使用最频繁的的方法，一般用来图像的相关处理，如图片压缩，水印合成等等</p></blockquote> <h3 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h3> <div class="language-js extra-class"><pre class="language-js"><code>context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">,</span> dWidth<span class="token punctuation">,</span> dHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> sx<span class="token punctuation">,</span> sy<span class="token punctuation">,</span> sWidth<span class="token punctuation">,</span> sHeight<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">,</span> dWidth<span class="token punctuation">,</span> dHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="参数说明"><a href="#参数说明" class="header-anchor">#</a> 参数说明</h3> <div class="language-js extra-class"><pre class="language-js"><code>image<span class="token punctuation">,</span>
sx<span class="token punctuation">,</span>  图片元素绘制在Canvas画布上起始横坐标。
sy<span class="token punctuation">,</span>  图片元素绘制在Canvas画布上起始纵坐标
sWidth<span class="token punctuation">,</span>  图片本身绘制在canvas上的长度
sHeight<span class="token punctuation">,</span>  图片本身绘制在canvas上的高度
dx<span class="token punctuation">,</span>  左上角横坐标
dy<span class="token punctuation">,</span>  左上角纵坐标
dWidth<span class="token punctuation">,</span>  绘制图片容器区域的宽度
dHeight  绘制图片容器区域的高度
</code></pre></div><h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>width<span class="token punctuation">,</span> height<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">]</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> width<span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;./images/dog.jpg&quot;</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> cxt <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// cxt.drawImage(img, 0, 0);</span>
				<span class="token comment">// cxt.drawImage(img, 0, 0, 50, 50);</span>
	cxt<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="createimagedata"><a href="#createimagedata" class="header-anchor">#</a> createImageData</h2> <blockquote><p>方法可以创建一个全新的空的ImageData对象。该对象中的所有像素信息都是透明黑。</p></blockquote> <h3 id="语法-2"><a href="#语法-2" class="header-anchor">#</a> 语法</h3> <div class="language-js extra-class"><pre class="language-js"><code>context<span class="token punctuation">.</span><span class="token function">createImageData</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span> 
context<span class="token punctuation">.</span><span class="token function">createImageData</span><span class="token punctuation">(</span>imagedata<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="参数说明-2"><a href="#参数说明-2" class="header-anchor">#</a> 参数说明</h3> <div class="language-js extra-class"><pre class="language-js"><code>width Number 
ImageData对象包含的width值。如果ImageData对象转换成图像，则此width也是最终图像呈现的宽度。
height Number
ImageData对象包含的height值。如果ImageData对象转换成图像，则此height也是最终图像呈现的高度。
imagedataObject
一个存在的ImageData对象，只会使用该ImageData对象中的width和height值，包含的像素信息会全部转换为透明黑。
</code></pre></div><div class="language-md extra-class"><pre class="language-md"><code>::: 提示
生成的ImageData里面的data值为一个数组   其中四个值组成一个像素点的值
:::
</code></pre></div><h2 id="putimagedata"><a href="#putimagedata" class="header-anchor">#</a> putImageData</h2> <blockquote><p>将给定ImageData对象的数据绘制到位图上。 如果提供脏矩形，则仅绘制该矩形的像素。 此方法不受画布变换矩阵的影响。</p></blockquote> <h3 id="语法-3"><a href="#语法-3" class="header-anchor">#</a> 语法</h3> <div class="language-js extra-class"><pre class="language-js"><code>context<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imagedata<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imagedata<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">,</span> dirtyX<span class="token punctuation">,</span> dirtyY<span class="token punctuation">,</span> dirtyWidth<span class="token punctuation">,</span> dirtyHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="参数"><a href="#参数" class="header-anchor">#</a> 参数</h3> <div class="language-js extra-class"><pre class="language-js"><code>imagedata<span class="token punctuation">,</span>
dx<span class="token punctuation">,</span>  绘制在Canvas画布上起始横坐标。
dy<span class="token punctuation">,</span>  绘制在Canvas画布上起始纵坐标
dirtyX<span class="token punctuation">,</span>  图像数据渲染区域的左上角横坐标。默认值是<span class="token number">0</span>
dirtyY<span class="token punctuation">,</span>  图像数据渲染区域的左上角纵坐标。默认值是<span class="token number">0</span>。
dirtyWidth<span class="token punctuation">,</span>  图像数据渲染区域的宽度
dirtyHeight<span class="token punctuation">,</span>  图像数据渲染区域的高度
</code></pre></div><h2 id="getimagedata"><a href="#getimagedata" class="header-anchor">#</a> getImageData</h2> <blockquote><p>返回一个ImageData对象，其中包含Canvas画布部分或完整的像素点信息。</p></blockquote> <h3 id="语法-4"><a href="#语法-4" class="header-anchor">#</a> 语法</h3> <div class="language-js extra-class"><pre class="language-js"><code>context<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span>sx<span class="token punctuation">,</span> sy<span class="token punctuation">,</span> sWidth<span class="token punctuation">,</span> sHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="参数-2"><a href="#参数-2" class="header-anchor">#</a> 参数</h3> <div class="language-js extra-class"><pre class="language-js"><code>sx Number
需要返回的图像数据区域的起始横坐标。
sy Number
需要返回的图像数据区域的起始纵坐标。
sWidth Number
需要返回的图像数据区域的宽度。
sHeight Number
需要返回的图像数据区域的高度。
</code></pre></div><h2 id="htmlcanvaselement-toblob"><a href="#htmlcanvaselement-toblob" class="header-anchor">#</a> HTMLCanvasElement.toBlob()</h2> <h3 id="语法-5"><a href="#语法-5" class="header-anchor">#</a> 语法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">void</span> canvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> mimeType<span class="token punctuation">,</span> quality<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="参数-3"><a href="#参数-3" class="header-anchor">#</a> 参数</h3> <div class="language-js extra-class"><pre class="language-js"><code>callback   Function
       <span class="token function">toBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法执行成功后的回调方法，支持一个参数，表示当前转换的Blob对象。
mimeType（可选）String
       mimeType表示需要转换的图像的mimeType类型。默认值是image<span class="token operator">/</span>png，还可以是image<span class="token operator">/</span>jpeg，甚至image<span class="token operator">/</span>webp（前提浏览器        支持）等。
quality  （可选）Number
quality  <span class="token function">表示转换的图片质量。范围是0到1。由于Canvas的toBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span>方法转<span class="token constant">PNG</span>是无损的，因此，此参数默认是没有效的，除非，指 定图片mimeType是image<span class="token operator">/</span>jpeg或者image<span class="token operator">/</span>webp，此时默认压缩值是<span class="token number">0.92</span>。
</code></pre></div><h3 id="示例-2"><a href="#示例-2" class="header-anchor">#</a> 示例</h3> <div class="language-js extra-class"><pre class="language-js"><code>		canvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">let</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
			a<span class="token punctuation">.</span>href <span class="token operator">=</span> url<span class="token punctuation">;</span>
			a<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">&quot;图片&quot;</span><span class="token punctuation">;</span>
			a<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="htmlcanvaselement-todataurl"><a href="#htmlcanvaselement-todataurl" class="header-anchor">#</a> HTMLCanvasElement.toDataURL()</h2> <blockquote><p>Canvas本质上就是一个位图图像，因此，浏览器提供了若干API可以将Canvas图像转换成可以作为IMG呈现的数据，其中最老牌的方法就是HTMLCanvasElement.toDataURL()，此方法可以返回Canvas图像对应的data URI，也就是平常我们所说的base64地址。</p></blockquote> <h3 id="语法-6"><a href="#语法-6" class="header-anchor">#</a> 语法</h3> <div class="language-js extra-class"><pre class="language-js"><code>canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span>mimeType<span class="token punctuation">,</span> quality<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="参数-4"><a href="#参数-4" class="header-anchor">#</a> 参数</h3> <div class="language-js extra-class"><pre class="language-js"><code>mimeType（可选）String
    mimeType表示需要转换的图像的mimeType类型。默认值是image<span class="token operator">/</span>png，还可以是image<span class="token operator">/</span>jpeg，甚至image<span class="token operator">/</span>webp（前提浏览器支持）等。
quality（可选）Number
    quality表示转换的图片质量。范围是<span class="token number">0</span>到<span class="token number">1</span>。此参数要想有效，图片的mimeType需要是image<span class="token operator">/</span>jpeg或者image<span class="token operator">/</span>webp，其他mimeType值无效。默认压缩质量是<span class="token number">0.92</span><span class="token function">。根据自己的肉眼分辨，如果使用toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span>的quality参数对图片进行压缩，同样的压缩百分比呈现效果要比Adobe Photoshop差一些
</code></pre></div><h2 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h2> <h3 id="绘制图片"><a href="#绘制图片" class="header-anchor">#</a> 绘制图片</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;images/dog.jpg&quot;</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token punctuation">{</span> width<span class="token punctuation">,</span> height <span class="token punctuation">}</span> <span class="token operator">=</span> img<span class="token punctuation">;</span>
	ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> imgDt <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">//修改像素</span>
	<span class="token keyword">const</span> data <span class="token operator">=</span> imgDt<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">100000</span> <span class="token operator">||</span> i <span class="token operator">&gt;</span> <span class="token number">200000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
ctx<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imgDt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="图片置灰"><a href="#图片置灰" class="header-anchor">#</a> 图片置灰</h3> <div class="language-js extra-class"><pre class="language-js"><code>	<span class="token comment">/**@type {HTMLCanvasElement} */</span>
	img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> width<span class="token punctuation">,</span> height <span class="token punctuation">}</span> <span class="token operator">=</span> img<span class="token punctuation">;</span>
		ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> imgDt <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> data <span class="token operator">=</span> imgDt<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">const</span> <span class="token punctuation">[</span>r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">const</span> lm <span class="token operator">=</span> <span class="token number">0.299</span> <span class="token operator">*</span> r <span class="token operator">+</span> <span class="token number">0.587</span> <span class="token operator">*</span> g <span class="token operator">+</span> <span class="token number">0.114</span> <span class="token operator">*</span> b<span class="token punctuation">;</span>
			data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> lm<span class="token punctuation">;</span>
			data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> lm<span class="token punctuation">;</span>
			data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> lm<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		ctx<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imgDt<span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="马赛克图片"><a href="#马赛克图片" class="header-anchor">#</a> 马赛克图片</h3> <div class="language-js extra-class"><pre class="language-js"><code>img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> width<span class="token punctuation">,</span> height <span class="token punctuation">}</span> <span class="token operator">=</span> img<span class="token punctuation">;</span>
		ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> imgDt <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> data <span class="token operator">=</span> imgDt<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> height<span class="token punctuation">;</span> y <span class="token operator">+=</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> width<span class="token punctuation">;</span> x <span class="token operator">+=</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> ind <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
				<span class="token keyword">const</span> <span class="token punctuation">[</span>r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>data<span class="token punctuation">[</span>ind<span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>ind <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>ind <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">rgb(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>r<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>g<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
				ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> size<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2021/07/24 星期六  09:15:42</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/更多/杂七杂八.html">
        杂七杂八
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.301249b9.js" defer></script><script src="/assets/js/2.98a928dc.js" defer></script><script src="/assets/js/17.b6e2a80b.js" defer></script>
  </body>
</html>
